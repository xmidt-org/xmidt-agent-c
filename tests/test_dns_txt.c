/* SPDX-FileCopyrightText: 2008, 2021 Ed Rose, Weston Schmidt */
/* SPDX-License-Identifier: Apache-2.0 */

#include <CUnit/Basic.h>
#include <arpa/nameser.h>
#include <netinet/in.h>
#include <resolv.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#include <cjwt/cjwt.h>

#include <cutils/xxd.h>

#include "../src/dns_txt.h"

static void set_extra_line_record();
static void set_normal_record();
static void set_missing_record();
static void set_several_record();
static void set_nothing_for_us_record();
static void set_rcode1();
static void set_rcode2();
static void set_rcode3();
static void set_rcode4();
static void set_rcode5();
static void set_rcode6();
static void set_not_a_response();
static void set_different_opcode();
static void set_very_short_answer();
static void set_invalid_answer();
static void set_invalid_name_len();
static void set_too_many_questions();
static void set_no_answers();

const char *pub
    = "-----BEGIN PUBLIC KEY-----\n"
      "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2bAMQkfafCaU82SrEcO4\n"
      "2sbHwXJSVDx9dX50rDhOjmf1kLwbBri0vEQI9l9ps5794pJIu7hZJiApa/N9/cDx\n"
      "ZHDemGRh1zZ+imSEkUaORK9PGggfE/C4MZ7HFchlOm/dXgXqCdkpW7br7wnMqBKl\n"
      "Mr7y0p2MyuXrcBPh9kzYDKqNPe7OLJTMeBK6DJFo+9yHHMwJZr/BNYuoq8xOsF5M\n"
      "AaDEDMXx9L4+S5tm1nYBNwp7LnhbruCTE2Cw4KiG6T3qg+uvQqTXJJHLZegEMAJL\n"
      "JXVMHglgnNGbh7+9fm9Ij/YbHwJ6/CDVmPbKEbtAFxsBnPxZHlTXn7SrFQuIWRrS\n"
      "cwIDAQAB\n"
      "-----END PUBLIC KEY-----";

/* In case we need the private key to generate more of these.  DO NOT EVER use
 * this key or anything signed by it!!!!

-----BEGIN RSA PRIVATE KEY-----
MIIEpQIBAAKCAQEA2bAMQkfafCaU82SrEcO42sbHwXJSVDx9dX50rDhOjmf1kLwb
Bri0vEQI9l9ps5794pJIu7hZJiApa/N9/cDxZHDemGRh1zZ+imSEkUaORK9PGggf
E/C4MZ7HFchlOm/dXgXqCdkpW7br7wnMqBKlMr7y0p2MyuXrcBPh9kzYDKqNPe7O
LJTMeBK6DJFo+9yHHMwJZr/BNYuoq8xOsF5MAaDEDMXx9L4+S5tm1nYBNwp7Lnhb
ruCTE2Cw4KiG6T3qg+uvQqTXJJHLZegEMAJLJXVMHglgnNGbh7+9fm9Ij/YbHwJ6
/CDVmPbKEbtAFxsBnPxZHlTXn7SrFQuIWRrScwIDAQABAoIBAQDYe2DVkUtP57Z9
DgGp2vA8cS45zIzfRICnlahFlIFa0Tu+QbLGzmy+RRJ8oIonnNdyuHMoa74MUjOf
LTiAX54veqeC+WDre0AANNI4/ueAmq6ZfrYZSGyEvBfUK8Ovh4unc045mQKuOI0M
3Lvv8QrkGky08wUOyfOHM96k5+p7PFHozoTmLMvlhyeQA70RJGZGpV8HPHremSfZ
gl/NzMb+bvyf+XCyRRtug4+BpH9XNv7qn8TjrP07WVnyH4Qn2rjdwRZPAfnYZRmT
cq583HXTNmmiqJjytJ3A80O7zFxy+AaxRpI48IYObD9+olRXK/Fu5MVKERQ/ivht
6/43FXqxAoGBAP8AxGOn/sxGxiAhbgnHgWcFwDO1x9sA8WJ0aVejQPhLaRDxfbg1
YWQjoUM00URd6ifFZSgWi7RhsiSxZiFOsZDjkn4WCjvdPK0HzBvo6fNfTeyHp+R7
K23CajAbU6UEPwtx1Gij4k+Q4oGVgnnNGec6sZ/y6bboRSKq5vzoTTUPAoGBANqJ
7ooknJdw2WnyIfYg5CJpSHnEX9URSlCzjFA1Aynr6aWtVK6xBMPk4EME0vtBqc+x
MoBXaTCFDNo+KgLXhbF+HtaYbMmigxttZ0brYbTUEM7UnUEKykpgN4xGeQ1kDoGr
EdLnBaylvOsHL3QiVLgEW7D7AEtVEznqP0UYQLRdAoGBAPOAUwhqojeEmaqS4ZW7
CclLx4ZZXje1xcpjKTiDbwXqVLDWOVvOtWo/T71yUSZ8m51QtFC8frlH1SmOsNy7
XXnipb964ljZ4RfFa1V3avd4GVv1ChB2wTi1PlsjrRLVZDJUhyVI4VFjI7fkAcy3
WrXf6T+4YQ7E60e4dIwqc5dnAoGBAIcSHWcwfcB0NUxwJWF0rsw9+leYcgrE5wO+
FYk1WsE8WGrYGLDoJCPXgGyrvKMi0IvX33jHjfI5Kdpx9ZFQGAe+Bd1o1ERDt3jq
Q5znuroDIGhVrOQYgTM7CNogbI1EPFsUmq2ZsD4nKf6xsDi9R1N9Dhby7BmjeYCg
MX7JIKTZAoGAApbYlw4ip78pzrFqUYX4F1dlYvFkcnA/1um7Jr5cOG1MN9keiTKX
PJDsT6UyXvK4dnuWs4PbZUc4ZvuaaOAQStpWKBU4tWWoZfLyWKGTfSU2U7xrJwTZ
IYz1qKZW4wjUPOWh2oNaXHDgVFCOicEDgp8cV1YqonE/X/UwAbHnNUU=
-----END RSA PRIVATE KEY-----
*/

static const uint8_t *__nq_buf = NULL;
static int __nq_buf_len = 0;
int res_nquery(res_state statep,
               const char *dname, int class, int type,
               unsigned char *answer, int anslen)
{
    (void)statep;
    (void)dname;
    (void)class;
    (void)type;
    memcpy(answer, __nq_buf, __nq_buf_len);

    //printf("buff\n");
    //xxd(__nq_buf, __nq_buf_len, stdout);
    //printf("\n\nanswer\n");
    //xxd(answer, __nq_buf_len, stdout);

    return __nq_buf_len;
}


static int __ninit_rv = 0;
int res_ninit(res_state statep)
{
    (void)statep;

    return __ninit_rv;
}

void res_nclose(res_state statep)
{
    (void)statep;
}


void test_normal(void)
{
    XAcode err = XA_OK;
    struct dns_response *resp = NULL;
    struct dns_rr *rr = NULL;
    struct dns_xmidt_token *token = NULL;
    cjwt_t *jwt = NULL;

    set_normal_record();

    CU_ASSERT(XA_OK == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));

    CU_ASSERT_FATAL(XA_OK == err);
    CU_ASSERT_FATAL(NULL != resp);
    CU_ASSERT(__nq_buf_len == resp->len);
    CU_ASSERT(NULL != resp->full);

    CU_ASSERT(3 == resp->answer_count);
    CU_ASSERT_FATAL(NULL != resp->answers);

    rr = resp->answers;
    CU_ASSERT(16 == rr->type);
    CU_ASSERT(1 == rr->class);
    CU_ASSERT(60 == rr->ttl);
    CU_ASSERT(256 == rr->rdlength);
    CU_ASSERT(NULL != rr->rdata);
    CU_ASSERT_FATAL(NULL != rr->next);

    rr = rr->next;
    CU_ASSERT(16 == rr->type);
    CU_ASSERT(1 == rr->class);
    CU_ASSERT(60 == rr->ttl);
    CU_ASSERT(256 == rr->rdlength);
    CU_ASSERT(NULL != rr->rdata);
    CU_ASSERT_FATAL(NULL != rr->next);

    rr = rr->next;
    CU_ASSERT(16 == rr->type);
    CU_ASSERT(1 == rr->class);
    CU_ASSERT(60 == rr->ttl);
    CU_ASSERT(50 == rr->rdlength);
    CU_ASSERT(NULL != rr->rdata);
    CU_ASSERT_FATAL(NULL == rr->next);

    /* The result looks good.  Let's go ahead and assemble it. */

    CU_ASSERT(XA_OK == dns_token_assemble(resp, &token, &err));
    CU_ASSERT_FATAL(XA_OK == err);
    CU_ASSERT_FATAL(NULL != token);
    CU_ASSERT(60 == token->ttl);
    CU_ASSERT(550 == token->len);
    CU_ASSERT_FATAL(NULL != token->buf);

    /* The result looks good.  Let's go ahead and decode it as a jwt. */

    CU_ASSERT(CJWTE_OK == cjwt_decode(token->buf, token->len, 0, (uint8_t *)pub, strlen(pub), 1300, 0, &jwt));

    CU_ASSERT_FATAL(NULL != jwt);

    dns_destroy_response(resp);
    dns_destroy_token(token);
    cjwt_destroy(jwt);
}


void test_extra_line(void)
{
    XAcode err = XA_OK;
    struct dns_response *resp = NULL;
    struct dns_xmidt_token *token = NULL;
    cjwt_t *jwt = NULL;

    set_extra_line_record();

    CU_ASSERT(XA_OK == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));

    CU_ASSERT_FATAL(XA_OK == err);
    CU_ASSERT_FATAL(NULL != resp);
    CU_ASSERT(__nq_buf_len == resp->len);
    CU_ASSERT(NULL != resp->full);

    CU_ASSERT(12 == resp->answer_count);
    CU_ASSERT_FATAL(NULL != resp->answers);

    /* The result looks good.  Let's go ahead and assemble it. */

    CU_ASSERT(XA_OK == dns_token_assemble(resp, &token, &err));
    CU_ASSERT_FATAL(XA_OK == err);
    CU_ASSERT_FATAL(NULL != token);
    CU_ASSERT(300 == token->ttl);
    CU_ASSERT(550 == token->len);
    CU_ASSERT_FATAL(NULL != token->buf);

    /* The result looks good.  Let's go ahead and decode it as a jwt. */

    CU_ASSERT(CJWTE_OK == cjwt_decode(token->buf, token->len, 0, (uint8_t *)pub, strlen(pub), 1300, 0, &jwt));

    CU_ASSERT_FATAL(NULL != jwt);

    dns_destroy_response(resp);
    dns_destroy_token(token);
    cjwt_destroy(jwt);
}

void test_several(void)
{
    XAcode err = XA_OK;
    struct dns_response *resp = NULL;
    struct dns_xmidt_token *token = NULL;
    cjwt_t *jwt = NULL;

    set_several_record();

    CU_ASSERT(XA_OK == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));

    CU_ASSERT_FATAL(XA_OK == err);
    CU_ASSERT_FATAL(NULL != resp);
    CU_ASSERT(__nq_buf_len == resp->len);
    CU_ASSERT(NULL != resp->full);
    CU_ASSERT_FATAL(NULL != resp->answers);

    /* The result looks good.  Let's go ahead and assemble it. */

    CU_ASSERT(XA_OK == dns_token_assemble(resp, &token, &err));
    CU_ASSERT_FATAL(XA_OK == err);
    CU_ASSERT_FATAL(NULL != token);

    /* The result looks good.  Let's go ahead and decode it as a jwt. */

    CU_ASSERT(CJWTE_OK == cjwt_decode(token->buf, token->len, 0, (uint8_t *)pub, strlen(pub), 1300, 0, &jwt));

    CU_ASSERT_FATAL(NULL != jwt);

    dns_destroy_response(resp);
    dns_destroy_token(token);
    cjwt_destroy(jwt);
}


void test_missing(void)
{
    XAcode err = XA_OK;
    struct dns_response *resp = NULL;
    struct dns_xmidt_token *token = NULL;
    cjwt_t *jwt = NULL;

    set_missing_record();

    CU_ASSERT(XA_OK == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));

    CU_ASSERT_FATAL(XA_OK == err);
    CU_ASSERT_FATAL(NULL != resp);
    CU_ASSERT(__nq_buf_len == resp->len);
    CU_ASSERT(NULL != resp->full);
    CU_ASSERT_FATAL(NULL != resp->answers);

    /* The result looks good.  Let's go ahead and assemble it. */

    CU_ASSERT(XA_OK == dns_token_assemble(resp, &token, &err));
    CU_ASSERT_FATAL(XA_OK == err);
    CU_ASSERT_FATAL(NULL != token);

    /* The result looks good.  Let's go ahead and decode it as a jwt. */

    CU_ASSERT(CJWTE_OK != cjwt_decode(token->buf, token->len, 0, (uint8_t *)pub, strlen(pub), 1300, 0, &jwt));

    /* The only realy way to tell if the token is valid is to decode it & validate
     * the signature.  */
    CU_ASSERT_FATAL(NULL == jwt);

    dns_destroy_response(resp);
    dns_destroy_token(token);
}


void test_nothing_for_us(void)
{
    XAcode err = XA_OK;
    struct dns_response *resp = NULL;
    struct dns_xmidt_token *token = NULL;

    set_nothing_for_us_record();

    CU_ASSERT(XA_OK == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));

    CU_ASSERT(XA_DNS_TOKEN_NOT_PRESENT == dns_token_assemble(resp, &token, &err));
    CU_ASSERT(XA_DNS_TOKEN_NOT_PRESENT == err);
    CU_ASSERT(NULL == token);

    dns_destroy_response(resp);
}


void test_nothing_for_us_short(void)
{
    XAcode err = XA_OK;
    struct dns_response *resp = NULL;
    struct dns_xmidt_token *token = NULL;

    set_very_short_answer();

    CU_ASSERT(XA_OK == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));

    CU_ASSERT(XA_DNS_TOKEN_NOT_PRESENT == dns_token_assemble(resp, &token, &err));
    CU_ASSERT(XA_DNS_TOKEN_NOT_PRESENT == err);
    CU_ASSERT(NULL == token);

    dns_destroy_response(resp);
}


void test_expected_dns_record(void)
{
    XAcode err = XA_OK;
    struct dns_response *resp = NULL;

    set_rcode1();
    CU_ASSERT(XA_DNS_FORMAT_ERROR == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_FORMAT_ERROR == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    set_rcode2();
    CU_ASSERT(XA_DNS_SERVER_ERROR == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_SERVER_ERROR == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    set_rcode3();
    CU_ASSERT(XA_DNS_NAME_ERROR == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_NAME_ERROR == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    set_rcode4();
    CU_ASSERT(XA_DNS_NOT_IMPLEMENTED == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_NOT_IMPLEMENTED == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    set_rcode5();
    CU_ASSERT(XA_DNS_REFUSED == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_REFUSED == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    set_rcode6();
    CU_ASSERT(XA_DNS_UNKNOWN_VALUE == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_UNKNOWN_VALUE == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    set_not_a_response();
    CU_ASSERT(XA_DNS_FORMAT_ERROR == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_FORMAT_ERROR == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    set_different_opcode();
    CU_ASSERT(XA_DNS_FORMAT_ERROR == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_FORMAT_ERROR == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    set_invalid_answer();
    CU_ASSERT(XA_DNS_RECORD_TOO_SHORT == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_RECORD_TOO_SHORT == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    set_invalid_name_len();
    CU_ASSERT(XA_DNS_RECORD_INVALID == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_RECORD_INVALID == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    set_too_many_questions();
    CU_ASSERT(XA_DNS_FORMAT_ERROR == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_FORMAT_ERROR == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    set_no_answers();
    CU_ASSERT(XA_DNS_TOO_FEW_ANSWERS == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_TOO_FEW_ANSWERS == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    __nq_buf_len = 0;
    CU_ASSERT(XA_DNS_RESOLVER_ERROR == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_RESOLVER_ERROR == err);
    CU_ASSERT(NULL == resp);
}


void test_input_tests(void)
{
    XAcode err = XA_OK;
    struct dns_response *resp = NULL;
    struct dns_xmidt_token *token = NULL;
    struct dns_response r;


    err = XA_OK;
    CU_ASSERT(XA_INVALID_INPUT == dns_txt_fetch(NULL, &resp, &err));
    CU_ASSERT(XA_INVALID_INPUT == err);
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    CU_ASSERT(XA_INVALID_INPUT == dns_txt_fetch("112233445566.test-xmidt-example.com", NULL, &err));
    CU_ASSERT(XA_INVALID_INPUT == err);

    err = XA_OK;
    CU_ASSERT(XA_INVALID_INPUT == dns_txt_fetch("112233445566.test-xmidt-example.com", NULL, NULL));
    CU_ASSERT(NULL == resp);

    err = XA_OK;
    CU_ASSERT(XA_INVALID_INPUT == dns_token_assemble(NULL, &token, &err));
    CU_ASSERT(XA_INVALID_INPUT == err);

    err = XA_OK;
    CU_ASSERT(XA_INVALID_INPUT == dns_token_assemble(&r, NULL, &err));
    CU_ASSERT(XA_INVALID_INPUT == err);

    CU_ASSERT(XA_INVALID_INPUT == dns_token_assemble(&r, NULL, NULL));

    dns_destroy_response(NULL);
    dns_destroy_token(NULL);
}


void test_shrink_without_crash(void)
{
    set_normal_record();

    /* Trim off the trailing parts of the DNS response that we don't
     * examine to get to where we should fail. */
    __nq_buf_len = 651;

    while (__nq_buf_len) {
        XAcode err = XA_OK;
        struct dns_response *resp = NULL;

        __nq_buf_len--;

        CU_ASSERT(XA_OK != dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
        CU_ASSERT(XA_OK != err);
        CU_ASSERT(NULL == resp);
    }
}


void test_ninit_fails(void)
{
    struct dns_response *resp = NULL;
    XAcode err = XA_OK;

    __ninit_rv = -1;
    CU_ASSERT(XA_DNS_RESOLVER_ERROR == dns_txt_fetch("112233445566.test-xmidt-example.com", &resp, &err));
    CU_ASSERT(XA_DNS_RESOLVER_ERROR == err);
    __ninit_rv = 0;
}


void add_suites(CU_pSuite *suite)
{
    *suite = CU_add_suite("utils.c tests", NULL, NULL);
    CU_add_test(*suite, "Test normal TXT record", test_normal);
    CU_add_test(*suite, "Test extra TXT line", test_extra_line);
    CU_add_test(*suite, "Shrink the response to fuzz a bit", test_shrink_without_crash);
    CU_add_test(*suite, "Test if expected dns checks work", test_expected_dns_record);
    CU_add_test(*suite, "Test nothing for us TXT record", test_nothing_for_us);
    CU_add_test(*suite, "Test nothing for us with short TXT record", test_nothing_for_us_short);
    CU_add_test(*suite, "Test many TXT lines", test_several);
    CU_add_test(*suite, "Test missing a TXT record", test_missing);
    CU_add_test(*suite, "Test res_ninit() failing", test_ninit_fails);
    CU_add_test(*suite, "Test input boundary testing", test_input_tests);
}


/*----------------------------------------------------------------------------*/
/*                             External Functions                             */
/*----------------------------------------------------------------------------*/
int main(void)
{
    unsigned rv = 1;
    CU_pSuite suite = NULL;

    if (CUE_SUCCESS == CU_initialize_registry()) {
        add_suites(&suite);

        if (NULL != suite) {
            CU_basic_set_mode(CU_BRM_VERBOSE);
            CU_basic_run_tests();
            printf("\n");
            CU_basic_show_failures(CU_get_failure_list());
            printf("\n\n");
            rv = CU_get_number_of_tests_failed();
        }

        CU_cleanup_registry();
    }

    if (0 != rv) {
        return 1;
    }

    return 0;
}

/*----------------------------------------------------------------------------*/
/*                           Data vector functions                            */
/*----------------------------------------------------------------------------*/
static void set_extra_line_record()
{
    static const uint8_t d[] = {
        0xe5, 0xd9, 0x81, 0x80, 0x00, 0x01, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x39, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x32, 0x3a, 0x44, 0x6b, 0x35,
        0x4f, 0x54, 0x6b, 0x35, 0x4c, 0x43, 0x4a, 0x70, 0x63, 0x33, 0x4d, 0x69,
        0x4f, 0x69, 0x4a, 0x54, 0x53, 0x45, 0x45, 0x79, 0x4e, 0x54, 0x59, 0x36,
        0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77,
        0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x33, 0x3a, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77,
        0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77,
        0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77,
        0x4d, 0x43, 0x49, 0x73, 0x49, 0x6d, 0x56, 0x75, 0x5a, 0x48, 0x42, 0x76,
        0x61, 0x57, 0x35, 0x30, 0x49, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x34, 0x3a, 0x6a, 0x6f, 0x69,
        0x61, 0x48, 0x52, 0x30, 0x63, 0x48, 0x4d, 0x36, 0x4c, 0x79, 0x39, 0x6d,
        0x59, 0x57, 0x4a, 0x79, 0x61, 0x57, 0x4d, 0x75, 0x65, 0x47, 0x31, 0x70,
        0x5a, 0x48, 0x51, 0x75, 0x5a, 0x58, 0x68, 0x68, 0x62, 0x58, 0x42, 0x73,
        0x5a, 0x53, 0x35, 0x6a, 0x62, 0x32, 0x30, 0x36, 0x4f, 0x44, 0x41, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x35, 0x3a, 0x34, 0x4d, 0x43, 0x38, 0x69, 0x66, 0x51, 0x2e, 0x77,
        0x39, 0x44, 0x56, 0x35, 0x50, 0x46, 0x38, 0x57, 0x7a, 0x44, 0x49, 0x35,
        0x76, 0x64, 0x58, 0x5f, 0x4c, 0x4c, 0x2d, 0x70, 0x44, 0x33, 0x62, 0x74,
        0x62, 0x4e, 0x6b, 0x48, 0x44, 0x38, 0x69, 0x72, 0x6d, 0x73, 0x66, 0x6a,
        0x76, 0x68, 0x54, 0x36, 0x50, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x36, 0x3a, 0x6a, 0x37, 0x50,
        0x4c, 0x57, 0x54, 0x52, 0x54, 0x4f, 0x77, 0x61, 0x5f, 0x34, 0x51, 0x70,
        0x50, 0x4c, 0x49, 0x73, 0x6f, 0x59, 0x49, 0x77, 0x72, 0x67, 0x72, 0x6e,
        0x43, 0x67, 0x69, 0x32, 0x31, 0x38, 0x53, 0x73, 0x78, 0x79, 0x77, 0x33,
        0x42, 0x35, 0x48, 0x54, 0x6a, 0x7a, 0x52, 0x6e, 0x34, 0x62, 0x65, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x37, 0x3a, 0x55, 0x79, 0x41, 0x34, 0x79, 0x43, 0x61, 0x49, 0x6b,
        0x4b, 0x57, 0x64, 0x7a, 0x65, 0x45, 0x56, 0x7a, 0x70, 0x54, 0x78, 0x4b,
        0x66, 0x48, 0x74, 0x57, 0x49, 0x68, 0x79, 0x55, 0x56, 0x6a, 0x69, 0x48,
        0x48, 0x56, 0x69, 0x62, 0x76, 0x42, 0x72, 0x45, 0x39, 0x30, 0x5f, 0x62,
        0x6b, 0x44, 0x72, 0x71, 0x72, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x38, 0x3a, 0x5f, 0x68, 0x4c,
        0x6d, 0x55, 0x4e, 0x31, 0x49, 0x41, 0x47, 0x72, 0x6e, 0x79, 0x68, 0x32,
        0x51, 0x2d, 0x5a, 0x51, 0x35, 0x39, 0x48, 0x47, 0x4c, 0x70, 0x45, 0x39,
        0x37, 0x59, 0x47, 0x32, 0x41, 0x48, 0x67, 0x31, 0x69, 0x79, 0x76, 0x31,
        0x59, 0x41, 0x76, 0x39, 0x78, 0x59, 0x65, 0x59, 0x75, 0x4a, 0x79, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x39, 0x3a, 0x36, 0x56, 0x37, 0x74, 0x70, 0x2d, 0x6f, 0x52, 0x73,
        0x6e, 0x6c, 0x79, 0x41, 0x78, 0x59, 0x6d, 0x59, 0x74, 0x31, 0x4b, 0x4d,
        0x6b, 0x38, 0x4e, 0x32, 0x73, 0x47, 0x72, 0x42, 0x73, 0x61, 0x68, 0x4e,
        0x48, 0x74, 0x77, 0x73, 0x73, 0x6d, 0x74, 0x72, 0x57, 0x6a, 0x57, 0x2d,
        0x36, 0x75, 0x4d, 0x36, 0x45, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x31, 0x30, 0x3a, 0x49, 0x6d, 0x6b,
        0x56, 0x5f, 0x4e, 0x38, 0x67, 0x64, 0x64, 0x2d, 0x2d, 0x63, 0x45, 0x30,
        0x6c, 0x39, 0x6b, 0x77, 0x51, 0x6c, 0x36, 0x55, 0x41, 0x36, 0x67, 0x75,
        0x39, 0x78, 0x36, 0x65, 0x4c, 0x70, 0x6a, 0x6b, 0x7a, 0x4e, 0x7a, 0x39,
        0x30, 0x6b, 0x52, 0x4a, 0x45, 0x47, 0x34, 0x50, 0x47, 0x31, 0x43, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x31, 0x31, 0x3a, 0x54, 0x34, 0x51, 0x47, 0x52, 0x59, 0x79, 0x61, 0x38,
        0x75, 0x69, 0x4c, 0x54, 0x4a, 0x41, 0x49, 0x58, 0x76, 0x4f, 0x44, 0x36,
        0x6e, 0x47, 0x6f, 0x7a, 0x67, 0x6e, 0x33, 0x59, 0x6a, 0x49, 0x69, 0x6a,
        0x53, 0x61, 0x43, 0x70, 0x33, 0x58, 0x64, 0x2d, 0x57, 0x75, 0x75, 0x6f,
        0x5a, 0x79, 0x73, 0x78, 0x67, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x10, 0x0f, 0x69, 0x67, 0x6e, 0x6f, 0x72, 0x65,
        0x20, 0x74, 0x68, 0x69, 0x73, 0x20, 0x72, 0x6f, 0x77, 0xc0, 0x0c, 0x00,
        0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x31,
        0x3a, 0x65, 0x79, 0x4a, 0x68, 0x62, 0x47, 0x63, 0x69, 0x4f, 0x69, 0x4a,
        0x53, 0x55, 0x7a, 0x49, 0x31, 0x4e, 0x69, 0x49, 0x73, 0x49, 0x6e, 0x52,
        0x35, 0x63, 0x43, 0x49, 0x36, 0x49, 0x6b, 0x70, 0x58, 0x56, 0x43, 0x4a,
        0x39, 0x2e, 0x65, 0x79, 0x4a, 0x6c, 0x65, 0x48, 0x41, 0x69, 0x4f, 0x6a,
        0x45, 0x30, 0x4d, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_normal_record()
{
    static const uint8_t d[] = {
        0x3a, 0xd5, 0x81, 0x80, 0x00, 0x01, 0x00, 0x03, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x36, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x3c, 0x01, 0x00, 0xff, 0x30, 0x31, 0x3a, 0x65, 0x79, 0x4a,
        0x68, 0x62, 0x47, 0x63, 0x69, 0x4f, 0x69, 0x4a, 0x53, 0x55, 0x7a, 0x49,
        0x31, 0x4e, 0x69, 0x49, 0x73, 0x49, 0x6e, 0x52, 0x35, 0x63, 0x43, 0x49,
        0x36, 0x49, 0x6b, 0x70, 0x58, 0x56, 0x43, 0x4a, 0x39, 0x2e, 0x65, 0x79,
        0x4a, 0x6c, 0x65, 0x48, 0x41, 0x69, 0x4f, 0x6a, 0x45, 0x30, 0x4d, 0x44,
        0x6b, 0x35, 0x4f, 0x54, 0x6b, 0x35, 0x4c, 0x43, 0x4a, 0x70, 0x63, 0x33,
        0x4d, 0x69, 0x4f, 0x69, 0x4a, 0x54, 0x53, 0x45, 0x45, 0x79, 0x4e, 0x54,
        0x59, 0x36, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44,
        0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44,
        0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44,
        0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44,
        0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x43,
        0x49, 0x73, 0x49, 0x6d, 0x56, 0x75, 0x5a, 0x48, 0x42, 0x76, 0x61, 0x57,
        0x35, 0x30, 0x49, 0x6a, 0x6f, 0x69, 0x61, 0x48, 0x52, 0x30, 0x63, 0x48,
        0x4d, 0x36, 0x4c, 0x79, 0x39, 0x6d, 0x59, 0x57, 0x4a, 0x79, 0x61, 0x57,
        0x4d, 0x75, 0x65, 0x47, 0x31, 0x70, 0x5a, 0x48, 0x51, 0x75, 0x5a, 0x58,
        0x68, 0x68, 0x62, 0x58, 0x42, 0x73, 0x5a, 0x53, 0x35, 0x6a, 0x62, 0x32,
        0x30, 0x36, 0x4f, 0x44, 0x41, 0x34, 0x4d, 0x43, 0x38, 0x69, 0x66, 0x51,
        0x2e, 0x77, 0x39, 0x44, 0x56, 0x35, 0x50, 0x46, 0x38, 0x57, 0x7a, 0x44,
        0x49, 0x35, 0x76, 0x64, 0x58, 0x5f, 0x4c, 0x4c, 0x2d, 0x70, 0x44, 0x33,
        0x62, 0x74, 0x62, 0x4e, 0x6b, 0x48, 0x44, 0x38, 0x69, 0x72, 0x6d, 0x73,
        0x66, 0x6a, 0x76, 0x68, 0x54, 0x36, 0x50, 0x6a, 0x37, 0xc0, 0x0c, 0x00,
        0x10, 0x00, 0x01, 0x00, 0x00, 0x00, 0x3c, 0x01, 0x00, 0xff, 0x30, 0x32,
        0x3a, 0x50, 0x4c, 0x57, 0x54, 0x52, 0x54, 0x4f, 0x77, 0x61, 0x5f, 0x34,
        0x51, 0x70, 0x50, 0x4c, 0x49, 0x73, 0x6f, 0x59, 0x49, 0x77, 0x72, 0x67,
        0x72, 0x6e, 0x43, 0x67, 0x69, 0x32, 0x31, 0x38, 0x53, 0x73, 0x78, 0x79,
        0x77, 0x33, 0x42, 0x35, 0x48, 0x54, 0x6a, 0x7a, 0x52, 0x6e, 0x34, 0x62,
        0x65, 0x55, 0x79, 0x41, 0x34, 0x79, 0x43, 0x61, 0x49, 0x6b, 0x4b, 0x57,
        0x64, 0x7a, 0x65, 0x45, 0x56, 0x7a, 0x70, 0x54, 0x78, 0x4b, 0x66, 0x48,
        0x74, 0x57, 0x49, 0x68, 0x79, 0x55, 0x56, 0x6a, 0x69, 0x48, 0x48, 0x56,
        0x69, 0x62, 0x76, 0x42, 0x72, 0x45, 0x39, 0x30, 0x5f, 0x62, 0x6b, 0x44,
        0x72, 0x71, 0x72, 0x5f, 0x68, 0x4c, 0x6d, 0x55, 0x4e, 0x31, 0x49, 0x41,
        0x47, 0x72, 0x6e, 0x79, 0x68, 0x32, 0x51, 0x2d, 0x5a, 0x51, 0x35, 0x39,
        0x48, 0x47, 0x4c, 0x70, 0x45, 0x39, 0x37, 0x59, 0x47, 0x32, 0x41, 0x48,
        0x67, 0x31, 0x69, 0x79, 0x76, 0x31, 0x59, 0x41, 0x76, 0x39, 0x78, 0x59,
        0x65, 0x59, 0x75, 0x4a, 0x79, 0x36, 0x56, 0x37, 0x74, 0x70, 0x2d, 0x6f,
        0x52, 0x73, 0x6e, 0x6c, 0x79, 0x41, 0x78, 0x59, 0x6d, 0x59, 0x74, 0x31,
        0x4b, 0x4d, 0x6b, 0x38, 0x4e, 0x32, 0x73, 0x47, 0x72, 0x42, 0x73, 0x61,
        0x68, 0x4e, 0x48, 0x74, 0x77, 0x73, 0x73, 0x6d, 0x74, 0x72, 0x57, 0x6a,
        0x57, 0x2d, 0x36, 0x75, 0x4d, 0x36, 0x45, 0x49, 0x6d, 0x6b, 0x56, 0x5f,
        0x4e, 0x38, 0x67, 0x64, 0x64, 0x2d, 0x2d, 0x63, 0x45, 0x30, 0x6c, 0x39,
        0x6b, 0x77, 0x51, 0x6c, 0x36, 0x55, 0x41, 0x36, 0x67, 0x75, 0x39, 0x78,
        0x36, 0x65, 0x4c, 0x70, 0x6a, 0x6b, 0x7a, 0x4e, 0x7a, 0x39, 0x30, 0x6b,
        0x52, 0x4a, 0x45, 0x47, 0x34, 0x50, 0x47, 0x31, 0x43, 0x54, 0x34, 0x51,
        0x47, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x00, 0x3c, 0x00,
        0x32, 0x31, 0x30, 0x33, 0x3a, 0x52, 0x59, 0x79, 0x61, 0x38, 0x75, 0x69,
        0x4c, 0x54, 0x4a, 0x41, 0x49, 0x58, 0x76, 0x4f, 0x44, 0x36, 0x6e, 0x47,
        0x6f, 0x7a, 0x67, 0x6e, 0x33, 0x59, 0x6a, 0x49, 0x69, 0x6a, 0x53, 0x61,
        0x43, 0x70, 0x33, 0x58, 0x64, 0x2d, 0x57, 0x75, 0x75, 0x6f, 0x5a, 0x79,
        0x73, 0x78, 0x67, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}

static void set_missing_record()
{
    static const uint8_t d[] = {
        0x57, 0xdd, 0x81, 0x80, 0x00, 0x01, 0x00, 0x0a, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x38, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x34, 0x3a, 0x6a, 0x6f, 0x69,
        0x61, 0x48, 0x52, 0x30, 0x63, 0x48, 0x4d, 0x36, 0x4c, 0x79, 0x39, 0x6d,
        0x59, 0x57, 0x4a, 0x79, 0x61, 0x57, 0x4d, 0x75, 0x65, 0x47, 0x31, 0x70,
        0x5a, 0x48, 0x51, 0x75, 0x5a, 0x58, 0x68, 0x68, 0x62, 0x58, 0x42, 0x73,
        0x5a, 0x53, 0x35, 0x6a, 0x62, 0x32, 0x30, 0x36, 0x4f, 0x44, 0x41, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x35, 0x3a, 0x34, 0x4d, 0x43, 0x38, 0x69, 0x66, 0x51, 0x2e, 0x77,
        0x39, 0x44, 0x56, 0x35, 0x50, 0x46, 0x38, 0x57, 0x7a, 0x44, 0x49, 0x35,
        0x76, 0x64, 0x58, 0x5f, 0x4c, 0x4c, 0x2d, 0x70, 0x44, 0x33, 0x62, 0x74,
        0x62, 0x4e, 0x6b, 0x48, 0x44, 0x38, 0x69, 0x72, 0x6d, 0x73, 0x66, 0x6a,
        0x76, 0x68, 0x54, 0x36, 0x50, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x36, 0x3a, 0x6a, 0x37, 0x50,
        0x4c, 0x57, 0x54, 0x52, 0x54, 0x4f, 0x77, 0x61, 0x5f, 0x34, 0x51, 0x70,
        0x50, 0x4c, 0x49, 0x73, 0x6f, 0x59, 0x49, 0x77, 0x72, 0x67, 0x72, 0x6e,
        0x43, 0x67, 0x69, 0x32, 0x31, 0x38, 0x53, 0x73, 0x78, 0x79, 0x77, 0x33,
        0x42, 0x35, 0x48, 0x54, 0x6a, 0x7a, 0x52, 0x6e, 0x34, 0x62, 0x65, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x37, 0x3a, 0x55, 0x79, 0x41, 0x34, 0x79, 0x43, 0x61, 0x49, 0x6b,
        0x4b, 0x57, 0x64, 0x7a, 0x65, 0x45, 0x56, 0x7a, 0x70, 0x54, 0x78, 0x4b,
        0x66, 0x48, 0x74, 0x57, 0x49, 0x68, 0x79, 0x55, 0x56, 0x6a, 0x69, 0x48,
        0x48, 0x56, 0x69, 0x62, 0x76, 0x42, 0x72, 0x45, 0x39, 0x30, 0x5f, 0x62,
        0x6b, 0x44, 0x72, 0x71, 0x72, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x38, 0x3a, 0x5f, 0x68, 0x4c,
        0x6d, 0x55, 0x4e, 0x31, 0x49, 0x41, 0x47, 0x72, 0x6e, 0x79, 0x68, 0x32,
        0x51, 0x2d, 0x5a, 0x51, 0x35, 0x39, 0x48, 0x47, 0x4c, 0x70, 0x45, 0x39,
        0x37, 0x59, 0x47, 0x32, 0x41, 0x48, 0x67, 0x31, 0x69, 0x79, 0x76, 0x31,
        0x59, 0x41, 0x76, 0x39, 0x78, 0x59, 0x65, 0x59, 0x75, 0x4a, 0x79, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x31, 0x30, 0x3a, 0x49, 0x6d, 0x6b, 0x56, 0x5f, 0x4e, 0x38, 0x67, 0x64,
        0x64, 0x2d, 0x2d, 0x63, 0x45, 0x30, 0x6c, 0x39, 0x6b, 0x77, 0x51, 0x6c,
        0x36, 0x55, 0x41, 0x36, 0x67, 0x75, 0x39, 0x78, 0x36, 0x65, 0x4c, 0x70,
        0x6a, 0x6b, 0x7a, 0x4e, 0x7a, 0x39, 0x30, 0x6b, 0x52, 0x4a, 0x45, 0x47,
        0x34, 0x50, 0x47, 0x31, 0x43, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x31, 0x31, 0x3a, 0x54, 0x34, 0x51,
        0x47, 0x52, 0x59, 0x79, 0x61, 0x38, 0x75, 0x69, 0x4c, 0x54, 0x4a, 0x41,
        0x49, 0x58, 0x76, 0x4f, 0x44, 0x36, 0x6e, 0x47, 0x6f, 0x7a, 0x67, 0x6e,
        0x33, 0x59, 0x6a, 0x49, 0x69, 0x6a, 0x53, 0x61, 0x43, 0x70, 0x33, 0x58,
        0x64, 0x2d, 0x57, 0x75, 0x75, 0x6f, 0x5a, 0x79, 0x73, 0x78, 0x67, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x31, 0x3a, 0x65, 0x79, 0x4a, 0x68, 0x62, 0x47, 0x63, 0x69, 0x4f,
        0x69, 0x4a, 0x53, 0x55, 0x7a, 0x49, 0x31, 0x4e, 0x69, 0x49, 0x73, 0x49,
        0x6e, 0x52, 0x35, 0x63, 0x43, 0x49, 0x36, 0x49, 0x6b, 0x70, 0x58, 0x56,
        0x43, 0x4a, 0x39, 0x2e, 0x65, 0x79, 0x4a, 0x6c, 0x65, 0x48, 0x41, 0x69,
        0x4f, 0x6a, 0x45, 0x30, 0x4d, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x32, 0x3a, 0x44, 0x6b, 0x35,
        0x4f, 0x54, 0x6b, 0x35, 0x4c, 0x43, 0x4a, 0x70, 0x63, 0x33, 0x4d, 0x69,
        0x4f, 0x69, 0x4a, 0x54, 0x53, 0x45, 0x45, 0x79, 0x4e, 0x54, 0x59, 0x36,
        0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77,
        0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x33, 0x3a, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77,
        0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77,
        0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77,
        0x4d, 0x43, 0x49, 0x73, 0x49, 0x6d, 0x56, 0x75, 0x5a, 0x48, 0x42, 0x76,
        0x61, 0x57, 0x35, 0x30, 0x49, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_several_record()
{
    static const uint8_t d[] = {
        0x34, 0x82, 0x81, 0x80, 0x00, 0x01, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x37, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x31, 0x3a, 0x65, 0x79, 0x4a,
        0x68, 0x62, 0x47, 0x63, 0x69, 0x4f, 0x69, 0x4a, 0x53, 0x55, 0x7a, 0x49,
        0x31, 0x4e, 0x69, 0x49, 0x73, 0x49, 0x6e, 0x52, 0x35, 0x63, 0x43, 0x49,
        0x36, 0x49, 0x6b, 0x70, 0x58, 0x56, 0x43, 0x4a, 0x39, 0x2e, 0x65, 0x79,
        0x4a, 0x6c, 0x65, 0x48, 0x41, 0x69, 0x4f, 0x6a, 0x45, 0x30, 0x4d, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x32, 0x3a, 0x44, 0x6b, 0x35, 0x4f, 0x54, 0x6b, 0x35, 0x4c, 0x43,
        0x4a, 0x70, 0x63, 0x33, 0x4d, 0x69, 0x4f, 0x69, 0x4a, 0x54, 0x53, 0x45,
        0x45, 0x79, 0x4e, 0x54, 0x59, 0x36, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44,
        0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44,
        0x41, 0x77, 0x4d, 0x44, 0x41, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x33, 0x3a, 0x77, 0x4d, 0x44,
        0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44,
        0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x44,
        0x41, 0x77, 0x4d, 0x44, 0x41, 0x77, 0x4d, 0x43, 0x49, 0x73, 0x49, 0x6d,
        0x56, 0x75, 0x5a, 0x48, 0x42, 0x76, 0x61, 0x57, 0x35, 0x30, 0x49, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x34, 0x3a, 0x6a, 0x6f, 0x69, 0x61, 0x48, 0x52, 0x30, 0x63, 0x48,
        0x4d, 0x36, 0x4c, 0x79, 0x39, 0x6d, 0x59, 0x57, 0x4a, 0x79, 0x61, 0x57,
        0x4d, 0x75, 0x65, 0x47, 0x31, 0x70, 0x5a, 0x48, 0x51, 0x75, 0x5a, 0x58,
        0x68, 0x68, 0x62, 0x58, 0x42, 0x73, 0x5a, 0x53, 0x35, 0x6a, 0x62, 0x32,
        0x30, 0x36, 0x4f, 0x44, 0x41, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x35, 0x3a, 0x34, 0x4d, 0x43,
        0x38, 0x69, 0x66, 0x51, 0x2e, 0x77, 0x39, 0x44, 0x56, 0x35, 0x50, 0x46,
        0x38, 0x57, 0x7a, 0x44, 0x49, 0x35, 0x76, 0x64, 0x58, 0x5f, 0x4c, 0x4c,
        0x2d, 0x70, 0x44, 0x33, 0x62, 0x74, 0x62, 0x4e, 0x6b, 0x48, 0x44, 0x38,
        0x69, 0x72, 0x6d, 0x73, 0x66, 0x6a, 0x76, 0x68, 0x54, 0x36, 0x50, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x36, 0x3a, 0x6a, 0x37, 0x50, 0x4c, 0x57, 0x54, 0x52, 0x54, 0x4f,
        0x77, 0x61, 0x5f, 0x34, 0x51, 0x70, 0x50, 0x4c, 0x49, 0x73, 0x6f, 0x59,
        0x49, 0x77, 0x72, 0x67, 0x72, 0x6e, 0x43, 0x67, 0x69, 0x32, 0x31, 0x38,
        0x53, 0x73, 0x78, 0x79, 0x77, 0x33, 0x42, 0x35, 0x48, 0x54, 0x6a, 0x7a,
        0x52, 0x6e, 0x34, 0x62, 0x65, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x37, 0x3a, 0x55, 0x79, 0x41,
        0x34, 0x79, 0x43, 0x61, 0x49, 0x6b, 0x4b, 0x57, 0x64, 0x7a, 0x65, 0x45,
        0x56, 0x7a, 0x70, 0x54, 0x78, 0x4b, 0x66, 0x48, 0x74, 0x57, 0x49, 0x68,
        0x79, 0x55, 0x56, 0x6a, 0x69, 0x48, 0x48, 0x56, 0x69, 0x62, 0x76, 0x42,
        0x72, 0x45, 0x39, 0x30, 0x5f, 0x62, 0x6b, 0x44, 0x72, 0x71, 0x72, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x30, 0x38, 0x3a, 0x5f, 0x68, 0x4c, 0x6d, 0x55, 0x4e, 0x31, 0x49, 0x41,
        0x47, 0x72, 0x6e, 0x79, 0x68, 0x32, 0x51, 0x2d, 0x5a, 0x51, 0x35, 0x39,
        0x48, 0x47, 0x4c, 0x70, 0x45, 0x39, 0x37, 0x59, 0x47, 0x32, 0x41, 0x48,
        0x67, 0x31, 0x69, 0x79, 0x76, 0x31, 0x59, 0x41, 0x76, 0x39, 0x78, 0x59,
        0x65, 0x59, 0x75, 0x4a, 0x79, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x30, 0x39, 0x3a, 0x36, 0x56, 0x37,
        0x74, 0x70, 0x2d, 0x6f, 0x52, 0x73, 0x6e, 0x6c, 0x79, 0x41, 0x78, 0x59,
        0x6d, 0x59, 0x74, 0x31, 0x4b, 0x4d, 0x6b, 0x38, 0x4e, 0x32, 0x73, 0x47,
        0x72, 0x42, 0x73, 0x61, 0x68, 0x4e, 0x48, 0x74, 0x77, 0x73, 0x73, 0x6d,
        0x74, 0x72, 0x57, 0x6a, 0x57, 0x2d, 0x36, 0x75, 0x4d, 0x36, 0x45, 0xc0,
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x01, 0x2c, 0x00, 0x36, 0x35,
        0x31, 0x30, 0x3a, 0x49, 0x6d, 0x6b, 0x56, 0x5f, 0x4e, 0x38, 0x67, 0x64,
        0x64, 0x2d, 0x2d, 0x63, 0x45, 0x30, 0x6c, 0x39, 0x6b, 0x77, 0x51, 0x6c,
        0x36, 0x55, 0x41, 0x36, 0x67, 0x75, 0x39, 0x78, 0x36, 0x65, 0x4c, 0x70,
        0x6a, 0x6b, 0x7a, 0x4e, 0x7a, 0x39, 0x30, 0x6b, 0x52, 0x4a, 0x45, 0x47,
        0x34, 0x50, 0x47, 0x31, 0x43, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x36, 0x35, 0x31, 0x31, 0x3a, 0x54, 0x34, 0x51,
        0x47, 0x52, 0x59, 0x79, 0x61, 0x38, 0x75, 0x69, 0x4c, 0x54, 0x4a, 0x41,
        0x49, 0x58, 0x76, 0x4f, 0x44, 0x36, 0x6e, 0x47, 0x6f, 0x7a, 0x67, 0x6e,
        0x33, 0x59, 0x6a, 0x49, 0x69, 0x6a, 0x53, 0x61, 0x43, 0x70, 0x33, 0x58,
        0x64, 0x2d, 0x57, 0x75, 0x75, 0x6f, 0x5a, 0x79, 0x73, 0x78, 0x67, 0x00,
        0x00, 0x29, 0xff, 0xd6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


/*
 * 00000000: 17eb 8180 0001 0001 0000 0001 0c31 3132  .............112
 * 00000010: 3233 3334 3435 3536 3512 7465 7374 2d78  233445565.test-x
 * 00000020: 6d69 6474 2d65 7861 6d70 6c65 0363 6f6d  midt-example.com
 * 00000030: 0000 1000 01c0 0c00 1000 0100 0001 2c00  ..............,.
 * 00000040: 0c0b 6e6f 7420 6865 6c70 6675 6c00 0029  ..not helpful..)
 * 00000050: ffd6 0000 0000 0000                      ........
*/
static void set_nothing_for_us_record()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x81, 0x80, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_rcode1()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x81, 0x81, /* 81 = rcode: 1 */
        0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_rcode2()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x81, 0x82, /* 82 = rcode: 2 */
        0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_rcode3()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x81, 0x83, /* 83 = rcode: 3 */
        0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_rcode4()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x81, 0x84, /* 84 = rcode: 4 */
        0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_rcode5()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x81, 0x85, /* 85 = rcode: 5 */
        0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_rcode6()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x81, 0x86, /* 86 = rcode: 6 */
        0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_not_a_response()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x01, /* Normally is 0x81, but 0x01 makes this a request */
        0x80, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_different_opcode()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x91, /* Normally is 0x81, but 0x91 alters the opcode */
        0x80, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_very_short_answer()
{
    static const uint8_t d[] = {
        0x7f, 0xa2, 0x81, 0x80, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x34, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x03, 0x02, 0x68, 0x69, 0x00, 0x00, 0x29, 0xff,
        0xd6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_invalid_answer()
{
    static const uint8_t d[] = {
        0x7f, 0xa2, 0x81, 0x80, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x34, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, /* shorten to here */
        0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x03, 0x02, 0x68, 0x69, 0x00, 0x00, 0x29, 0xff,
        0xd6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = 57;
}


static void set_invalid_name_len()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x81, 0x80, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0x80, /* This is an invalid length */
        0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_too_many_questions()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x81, 0x80, 0x00, 0x02, /* Too many questions */
        0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}


static void set_no_answers()
{
    static const uint8_t d[] = {
        0x17, 0xeb, 0x81, 0x80, 0x00, 0x01, 0x00, 0x00, /* No answers */
        0x00, 0x00, 0x00, 0x01,
        0x0c, 0x31, 0x31, 0x32, 0x32, 0x33, 0x33, 0x34, 0x34, 0x35, 0x35, 0x36,
        0x35, 0x12, 0x74, 0x65, 0x73, 0x74, 0x2d, 0x78, 0x6d, 0x69, 0x64, 0x74,
        0x2d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d,
        0x00, 0x00, 0x10, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
        0x00, 0x01, 0x2c, 0x00, 0x0c, 0x0b, 0x6e, 0x6f, 0x74, 0x20, 0x68, 0x65,
        0x6c, 0x70, 0x66, 0x75, 0x6c, 0x00, 0x00, 0x29, 0xff, 0xd6, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };

    __nq_buf = d;
    __nq_buf_len = sizeof(d);
}

